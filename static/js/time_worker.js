var timerStart = true;

function timer(initial_time) {
	// get current time
	var d = (new Date()).valueOf();
	// calculate time difference between now and initial time
	var diff = d - initial_time;
	// Convert to seconds:
	var seconds = diff / 1000;
	// Extract hours
	var hours = parseInt(seconds / 3600); // (3,600 seconds in 1 hour)
	seconds = seconds % 3600; // seconds remaining after extracting hours
	// Extract minutes
	var minutes = parseInt(seconds / 60); // (60 seconds in 1 minute)

	if (hours == 0 && minutes < 5) {
		postMessage('Updated: NOW ');
	} else if (hours == 0 && minutes > 4) {
		postMessage('Updated: ' + minutes + ' mins ago');
	} else if (hours == 1) {
		postMessage('Updated: ' + hours + 'hr ago');
	} else {
		postMessage('Updated: ' + hours + 'hrs ago');
	}
}

if (timerStart) {
	// get current time
	var initial_time = (new Date()).valueOf();
	timer(initial_time);
	// repeat timer(initial_time) every 5 minutes
	myVar = setInterval(function() {
		timer(initial_time)
	}, 300000);
	// timer should not start anymore since it has been started
	timerStart = false;
}
